<div class="panel panel-default">
	<div class="panel-heading">
		Comments: {{ taskManComm.task.name }} <em class="small pull-right">{{ taskManComm.task.status }}</em>
	</div>


	<table class="table table-condensed table-hover">
		<thead>
			<tr ng-show="taskManComm.showFilter" class="panel-sub-heading">
				<td class="text-right form-inline" colspan="4">

					<div class="form-group">
						<label class="control-label">Filter</label>
						<div class="input-group input-group-sm">
							<input ng-model="taskManComm.filterKeyword" type="text" class="form-control" placeholder="Filter">
							<span class="input-group-btn">
								<button class="btn btn-default" type="button" ng-click="taskManComm.filterKeyword = undefined"><span class="glyphicon glyphicon-remove"></span></button>
							</span>
						</div>						
					</div>

				</td>
			</tr>
		<thead>
			<tr class="small">
				<th width="59%">Comment</th>
				<th width="20%" class="text-center">Date</th>
				<th width="20%" class="text-center">Overall Status<br/>EAO Status<br/>Proponent Status</th>
				<th class="text-right"><a href ng-click="taskManComm.showFilter = !taskManComm.showFilter"><span class="glyphicon glyphicon-search"></span></a></th>
			</tr>
		</thead>
		<tbody>
			<tr ng-repeat="com in taskManComm.comments | filter:taskManComm.filterKeyword track by $index" ng-class="{'bg-danger': com.overallStatus === 'Rejected', 'bg-info': com.overallStatus === 'In Progress'}" ng-click="taskManComm.activeComments[com._id] = !taskManComm.activeComments[com._id]">
				<td>
					<div ng-show="taskManComm.activeComments[com._id]">
						<pre class="form-group">{{ com.comment }}</pre>
						<ul class="list-unstyled document-vetting">
							<li ng-repeat="doc in com.documents">
								<a href="/api/commentdocument/{{ doc._id }}/fetch" target="_blank" class="small" ng-if="doc.eaoStatus !== 'Rejected'"><span class="glyphicon glyphicon-file"></span> {{ doc.name }}</a>
								<span class="small text-warning" ng-if="doc.eaoStatus === 'Rejected'"><i class="glyphicon glyphicon-file"></i> {{ doc.name }} has not been shared as it does not meet the privacy policy rules.</span>
							</li>
							<li ng-if="com.documents.length === 0" class="small">
								There are no documents associated with this comment.
							</li>
						</ul>
					</div>
					<div ng-show="!taskManComm.activeComments[com._id]">
						<pre>{{ com.comment | max15Words }}</pre>
					</div>
				</td>
				<td class='text-center no-wrap'>
					{{ com.dateAdded | amDateFormat:'MMM Do, YYYY hh:mm a'}}
				</td>
				<td class='text-center small' title="Overall, EAO, Proponent">
					<span title="Overall">{{ com.overallStatus }}</span><br/>
					<span title="EAO">{{ com.eaoStatus }}</span><br/>
					<span title="Proponent">{{ com.proponentStatus }}</span>
				</td>
				<td></td>
			</tr>
			<tr ng-show="taskManComm.comments.length === 0">
				<td colspan="4">There are no comments to view.</td>
			</tr>
		</tbody>

	</table>

</div>
