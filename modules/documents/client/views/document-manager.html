<div class="file-browser">

	<div class="fb-header">
		<ul class="fb-breadcrumbs">
			<li ng-repeat="node in documentMgr.currentPath">
				<button class="btn icon-btn" ng-click="documentMgr.selectNode(node.model.id)">
					<span class="glyphicon glyphicon-hdd" ng-if="node.model.name == 'ROOT'"></span>
					<span ng-show="node.model.name != 'ROOT'">{{ node.model.name }}</span>
				</button>
			</li>
		</ul>
		<div class="file-batch-actions">
			
			<button class="btn icon-btn" title="Add New Folder" 
					ng-if="project.userCan.createDocument"
					ng-disabled="!documentMgr.selectedNode"
					x-document-mgr-add-folder
					x-project="project"
					x-root="documentMgr.rootNode"
					x-node="documentMgr.selectedNode"><span class="glyphicon glyphicon-folder-close"></span></button>

			<button class="btn icon-btn" title="Upload Files" 
					ng-if="project.userCan.createDocument"
					ng-disabled="!documentMgr.selectedNode"
					x-document-mgr-upload-modal
					x-project="project"
					x-root="documentMgr.rootNode"
					x-node="documentMgr.selectedNode"
					x-type="'project'"><span class="glyphicon glyphicon-open"></span></button>

			<button class="toggle-details-btn btn icon-btn" title="Show Details" 
					ng-click="documentMgr.infoPanel.toggle()"><span class="glyphicon glyphicon-info-sign"></span></button>

			<button class="btn icon-btn" title="Rename Folder" 
					ng-if="project.userCan.createDocument"
					ng-disabled="documentMgr.selectedDirs.length === 0"
					x-document-mgr-rename-folder
					x-project="project"
					x-root="documentMgr.rootNode"
					x-node="documentMgr.selectedDirs[0]"><span class="glyphicon glyphicon-pencil"></span></button>

			<button class="btn icon-btn" title="Delete" 
					ng-if="project.userCan.createDocument"
					ng-disabled="documentMgr.selectedDirs.length === 0 && documentMgr.selectedFiles.length === 0"
					x-confirm-dialog
					x-title-text="documentMgr.deleteSelected.titleText"
					x-ok-text="documentMgr.deleteSelected.okText"
					x-cancel-text="documentMgr.deleteSelected.cancelText"
					x-confirm-text="documentMgr.deleteSelected.confirmText"
					x-confirm-items="documentMgr.deleteSelected.confirmItems"
					x-on-ok="documentMgr.deleteSelected.ok"><span class="glyphicon glyphicon-trash"></span></button>
		</div>
	</div>

	<div id="fbBody" class="fb-body" ng-class="{'panel-open': documentMgr.infoPanel.enabled && documentMgr.infoPanel.open}">

		<div class="fb-list">

			<!-- Load the File/Folder Directory -->
			<!-- TODO: Remove 'hidden' selector when complete -->
			<div class="spinner-container hidden">
				<div class="spinner">
					<svg class="circular" viewBox="25 25 50 50">
					<circle class="spin-path" cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10"/>
					</svg>
				</div>
			</div>
			
			<div class="column-header">
				<span class="col select-col">
					<input type="checkbox"/>
				</span>

				<div class="fb-col-group">
					<div class="col name-col sortable" ng-class="{'descending': !documentMgr.sorting.ascending}" ng-click="documentMgr.sortBy('name')">
						<span>Name</span>
						<span class="sort-icon" ng-show="documentMgr.sorting.column === 'name'"></span>
					</div>
					<div class="col size-col sortable" ng-class="{'descending': !documentMgr.sorting.ascending}" ng-click="documentMgr.sortBy('size')">
						<span>Size</span>
						<span class="sort-icon" ng-show="documentMgr.sorting.column === 'size'"></span>
					</div>
					<div class="col type-col sortable" ng-class="{'descending': !documentMgr.sorting.ascending}" ng-click="documentMgr.sortBy('type')">
						<span>Type</span>
						<span class="sort-icon" ng-show="documentMgr.sorting.column === 'type'"></span>
					</div>
					<div class="col date-added-col sortable" ng-class="{'descending': !documentMgr.sorting.ascending}" ng-click="documentMgr.sortBy('date')">
						<span>Date Uploaded</span>
						<span class="sort-icon" ng-show="documentMgr.sorting.column === 'date'"></span>
					</div>
				</div>

			</div>
			<div class="scroll-container">
				<div class="scroll-container-inner">

					<div class="empty-directory-msg" ng-if="documentMgr.currentDirs.length == 0 && documentMgr.currentFiles.length == 0">This folder is empty.</div>

					<ul>
						<li class="fb-list-item" ng-class="{'selected': documentMgr.selectedDirIndex(doc) > -1}" ng-repeat="doc in documentMgr.currentDirs">
							<span class="col select-col">
								<input type="checkbox"/>
							</span>
							<span class="fb-col-group"  
								ng-click="$event.originalEvent.dropdown || documentMgr.toggleDir(doc)" 
								ng-dblclick="documentMgr.selectNode(doc.model.id)">
								<span class="col name-col">
									<span class="avatar">
										<span class="fb-folder glyphicon glyphicon-folder-close"></span>
									</span>
									{{ doc.model.name }}
								</span>
								<span class="col size-col">---</span>
								<span class="col type-col">---</span>
								<span class="col date-added-col">---</span>
								<div class="row-actions">
									
									<div class="btn-group">
										<button class="btn icon-btn dropdown-toggle" type="button" ng-click="$event.originalEvent.dropdown = true" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
											<span class="glyphicon glyphicon glyphicon-option-vertical"></span>	
										</button>
										<ul class="dropdown-menu pull-right">
											<li>
												<button class="btn icon-btn" title="Toggle Details" ng-click="documentMgr.infoPanel.toggle(); $event.stopPropagation();">
													<span class="glyphicon glyphicon-info-sign"></span>
												</button>
											</li>
											<li>
												<button class="btn icon-btn" title="Delete Folder" ng-click="$event.stopPropagation();"
														x-confirm-dialog
														x-title-text="'Delete Folder'"
														x-ok-text="'Yes'"
														x-cancel-text="'No'"
														x-confirm-text="'Are you sure you want to delete this folder? This action cannot be undone.'"
														x-confirm-items="[doc.model.name]"
														x-on-ok="documentMgr.deleteFolder"
												        x-ok-args="doc">
													<span class="glyphicon glyphicon-trash"></span>
												</button>
											</li>
											<li>
												<button class="btn icon-btn" title="Edit Folder Details" ng-click="$event.stopPropagation();"
														x-document-mgr-rename-folder
														x-project="project"
														x-root="documentMgr.rootNode"
														x-node="doc">
													<span class="glyphicon glyphicon-pencil"></span>
												</button>
											</li>
										</ul>
									</div>
									
								</div>
							</span>
						</li>
					</ul>
					<ul>
						<li class="fb-list-item" ng-class="{'selected': documentMgr.selectedFileIndex(doc) > -1}" ng-repeat="doc in documentMgr.currentFiles">
							<span class="col select-col">
								<input type="checkbox"/>
							</span>
							<span class="fb-col-group"
								ng-click="$event.originalEvent.dropdown || documentMgr.toggleFile(doc)">
								<span class="col name-col">
									<span class="avatar">
										<span class="fb-file glyphicon glyphicon-file" ng-if="doc.internalExt == 'pdf'"></span>
										<span class="fb-img glyphicon glyphicon-picture" ng-if="doc.internalExt == 'png' && 'jpg' && 'jpeg'"></span>
									</span>
									{{ doc.documentFileName | removeExtension }}
								</span>
								<span class="col size-col">{{ doc.internalSize | bytes:2 }}</span>
								<span class="col type-col">{{ doc.internalExt}}</span>
								<span class="col date-added-col">{{ doc.dateUploaded | date : format : timezone }}</span>
								<div class="row-actions">
									
									<div class="btn-group">
										<button class="btn icon-btn dropdown-toggle" type="button" ng-click="$event.originalEvent.dropdown = true" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
											<span class="glyphicon glyphicon glyphicon-option-vertical"></span>	
										</button>
										<ul class="dropdown-menu pull-right">
											<li>
												<button class="btn icon-btn" title="Toggle Details" ng-click="documentMgr.infoPanel.toggle()">
													<span class="glyphicon glyphicon-info-sign"></span>
												</button>
											</li>
											<li>
												<button class="btn icon-btn" title="Delete File"
														x-confirm-dialog
														x-title-text="'Delete File'"
														x-ok-text="'Yes'"
														x-cancel-text="'No'"
														x-confirm-text="'Are you sure you want to delete this file? This action cannot be undone'"
														x-confirm-items="[doc.documentFileName]"
														x-on-ok="documentMgr.deleteFile"
														x-ok-args="doc">
													<span class="glyphicon glyphicon-trash"></span>
												</button>
											</li>
											<!--
											<li>
												<button class="btn icon-btn" title="Edit Folder Details" ng-click="$event.stopPropagation();">
													<span class="glyphicon glyphicon-pencil"></span>
												</button>
											</li>
											-->
										</ul>
									</div>
									
								</div>
							</span>
						</li>
					</ul>
				</div>
			</div>

		</div>
		<div class="fb-details-panel">
			<!-- Load the File/Folder Details -->
			<!-- TODO: Remove 'hidden' selector when complete -->
			<div class="spinner-container hidden">
				<div class="spinner">
					<svg class="circular" viewBox="25 25 50 50">
					<circle class="spin-path" cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10"/>
					</svg>
				</div>
			</div>
			<div class="fb-details-content" ng-if="documentMgr.infoPanel.data && documentMgr.infoPanel.type === 'File'">
				<div class="title-panel">
					<button class="btn btn-default close" type="button" ng-click="documentMgr.infoPanel.close()">
						<span aria-hidden="true">&times;</span>
					</button>
					<h2>{{documentMgr.infoPanel.data.documentFileName | removeExtension }}</h2>
					<!--
					<h2>Fetching Details...</h2>
					-->
				</div>

				<div class="scroll-container">

					<section>
						<ul class="nv-pair">
							<li>
								<span class="name">Publish Status</span>
								<span class="value">
									<span class="label label-success" ng-if="documentMgr.infoPanel.data.isPublished">Published</span>
									<span class="label label-default" ng-if="!documentMgr.infoPanel.data.isPublished">Not Published</span>
								</span>
							</li>
							<li>
								<span class="name">Date uploaded</span>
								<span class="value">{{ documentMgr.infoPanel.data.dateUploaded | date : format : timezone }}</span>
							</li>
							<li>
								<span class="name">Modified</span>
								<span class="value">{{ documentMgr.infoPanel.data.dateUpdated | date : format : timezone }}</span>
							</li>
							<li>
								<span class="name">Last update by</span>
								<span class="value">{{ documentMgr.infoPanel.data.updatedBy.displayName }}</span>
							</li>
							<li>
								<span class="name">Size</span>
								<span class="value">{{ documentMgr.infoPanel.data.internalSize | bytes:2 }}</span>
							</li>
							<li>
								<span class="name">Type</span>
								<span class="value">{{ documentMgr.infoPanel.data.internalExt }}</span>
							</li>
						</ul>
					</section>
				</div>
			</div>
			<div class="fb-details-content" ng-if="documentMgr.infoPanel.data && documentMgr.infoPanel.type === 'Directory'">
				<div class="title-panel">
					<button class="btn btn-default close" type="button" ng-click="documentMgr.infoPanel.close()">
						<span aria-hidden="true">&times;</span>
					</button>
					<h2>{{documentMgr.infoPanel.data.name}}</h2>
					<!--
					<h2>Fetching Details...</h2>
					-->
				</div>

				<div class="scroll-container">
					<!-- TBD -->
				</div>
			</div>
			<div class="fb-details-content" ng-if="!documentMgr.infoPanel.data || documentMgr.infoPanel.type === 'None'">
				<div class="title-panel">
					<button class="btn btn-default close" type="button" ng-click="documentMgr.infoPanel.close()">
						<span aria-hidden="true">&times;</span>
					</button>
					<h2>{{project.name}}</h2>
				</div>
				<div class="scroll-container">
					Select a file or folder to view details.
				</div>
			</div>
		</div>
	</div>

</div>