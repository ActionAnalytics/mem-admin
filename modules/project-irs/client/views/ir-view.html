
<div class="view-title-container flex-row">
	<h1>Compliance Oversight &nbsp;&rsaquo;&nbsp; {{ir.name}}</h1>
	<div class="actions">
		<button class="btn btn-default btn-sm"
            ng-if="project.userCan.createInspectionReport"
			ng-click="$event.stopPropagation()"
			x-mode="'edit'"
			ui-sref="p.ir.edit({irId:ir._id})"><span class="glyphicon glyphicon-pencil"></span><span>Edit</span>
		</button>
		<tmpl-permissions-gear class="permission-btn" x-context="project" x-object="ir"></tmpl-permissions-gear>
	</div>
</div>

<div class="view-body-container">
	
	<div class="panel panel-default">
		<div class="panel-heading">
			<h2>Inspection Details</h2>
		</div>
		<div class="panel-body detail-panel">
			<div class="row">
				<div class="detail-row col-md-6">
					<label>Name</label>
					<span class="value">{{ ::ir.name }}</span>
				</div>
				<div class="detail-row col-md-6">
					<label>Date of Inspection</label>
					<span class="value">{{ ir.irDate | amDateFormat:'MMM Do YYYY'}}</span>
				</div>
			</div>
			<div class="row">
				<div class="col-sm-12 detail-row" ng-if="ir.conditionArtifacts.length > 0">
					<label>Certificate Requirements Inspected</label>
					<div class="anchor-list">
						<a ng-repeat="o in ir.conditionArtifacts" ui-sref="p.artifact.view({artifactId:o._id})">{{o.name}}{{$last ? '' : ', '}}</a>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-sm-12 detail-row" ng-if="ir.condition.length > 0">
					<label>Conditions</label>
					<ul class="anchor-list">
						<li ng-repeat="o in ir.conditionArtifacts" ui-sref="p.artifact.view({artifactId:o._id})">
							<a class="title">{{o.name}}</a>
						</li>
					</ul>
				</div>
			</div>
			<div class="row">
				<div class="col-sm-12 detail-row">
					<label>Inspection Record</label>
					<div class="anchor-list">
						<a ui-sref="p.artifact.view({artifactId:ir.artifact._id})">{{ir.artifact.name}}</a>
					</div>
				</div>
			</div>
		</div>
	</div>	
	
	<div class="panel panel-default">
		<div class="panel-heading">
			<h2>Enforcement Actions</h2>
		</div>
		<table ng-table="tableParams" class="enforcement-table table table-hover">
			<tr class="clickable" ui-sref="p.ir.detail({irId:o._id})" ng-repeat="o in ir.enforcementActions">
				<td class="enforcement-col"
					header-class="'enforcement-col'"
					data-title="'Action'" 
					sortable="'o.action'">
					<strong class="enforcement-name">{{o.action}}</strong>
					<span class="enforcement-notes" ng-if="o.notes">{{o.notes}}</span>
				</td>
				<td data-title="'Enforcement Conditions'">
					<div class="anchor-list">
						<a ng-repeat="cell in o.condition.concat(o.conditionArtifacts)">{{cell.name}}{{$last ? '' : ', '}}</a>
					</div>
				</td>
				<td data-title="'Order'">
					<ul class="anchor-list">
						<a href="#">{{o.orderArtifact.name}}</a>
					</ul>
				</td>
				<td class="status-col"
					header-class="'status-col'"
					data-title="'Status'"
					sortable="'status'">
					<span class="label"
						ng-class="{'label-primary': o.status == 'Open',
									'label-success': o.status == 'Resolved',
									'label-default': o.status == 'Recinded'}">{{o.status}}</span>
				</td>
				<td class="date-col"
					header-class="'date-col'"
					data-title="'Date Issued'"
					sortable="'date'">{{o.date | date:'MMM dd, yyyy'}}</td>
				<tr ng-show="ir.enforcementActions.length == 0">
					<td colspan="5">No Enforcement Actions found</td>
				</tr>
			</tr>
		</table>
	</div>

	<div class="form-footer no-border clearfix hidden">
		<a class="back-btn btn btn-link pull-left" ui-sref="p.ir.list"><span class="glyphicon glyphicon-chevron-left"></span>Back to Inspections</a>
	</div>

</div>